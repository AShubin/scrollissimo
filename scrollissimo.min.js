/**
 * Scrollissimo
 * Javascript plugin for scroll animation
 * @version 0.1.0
 * @author frux
 */
(function(e,f){function p(a,b,c,g){var d=Math.min(c,g),e=Math.max(c,g);if(d<=a&&e>=a)b=Math.min(e,b);else if(e>=b&&d<=b)a=Math.max(d,a),b=Math.min(e,b);else if(d>=a&&e<=b)b=a=d;else return;return c<g?{from:a,to:b}:{from:b,to:a}}function k(a,b){b=b||h||f(document).height();if("string"===typeof a){if("%"===a.substr(-1,1))return parseInt(a)/100;a.substr(-2,2);return parseInt(a)/b}if(!isNaN(a))return a/b}function q(a,b){if("object"===typeof a){var c={};c.property=a.property;c.from=a.from||0;c.to=a.to||
0;c.prefix=a.prefix||"";c.suffix=a.suffix||"";c.duration=k(a.duration)||0;c.target=a.target.jquery?a.target:f(a.target);"undefined"===typeof(c.start=k(a.start))&&(c.start=b.end);c.queue=b;return{animator:null,target:c.target,sourceParams:a,params:c,render:r.bind(this,c.start,c.duration,(a.func||function(a){this.css(c.property,c.prefix+(c.from+(c.to-c.from)*a)+c.suffix)}).bind(c.target)),recalc:function(a){a=a||f(document).height();this.params.duration=k(this.sourceParams.duration||"",a);"undefined"===
typeof this.sourceParams.start&&(this.params.start=k(this.sourceParams.start,a))},getIntersection:function(a,b){return p(this.params.start,this.params.start+this.params.duration,a,b)}}}}function r(a,b,c,d){a=(d-a)/b;0<a&&1>a?c(a):1<=a?c(1):0>=a&&c(0)}var d={},l,m=[],n=[],h;(function(){var a=0,b=["ms","moz","webkit","o"],c=b.length,g,f=!(!e.performance||!e.performance.now);if(e.requestAnimationFrame)d._requestAnimationFrame=e.requestAnimationFrame.bind(e);else{for(g=0;g<c&&!e.requestAnimationFrame;g+=
    1)d._requestAnimationFrame=e[b[g]+"RequestAnimationFrame"]&&e[b[g]+"RequestAnimationFrame"].bind(e);d._requestAnimationFrame||(d._requestAnimationFrame=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),g=e.setTimeout(function(){b(c+d)},d);a=c+d;return g}.bind(e))}if(!f){var h=d._requestAnimationFrame,k=+new Date;d._requestAnimationFrame=function(a,b){h(function(b){return a(1E12>b?b:b-k)},b)}}})();d._on=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,
    c)};d._getDocHeight=function(){var a=document.documentElement||{},b=document.body||{};return Math.max(b.scrollHeight,a.scrollHeight,b.offsetHeight,a.offsetHeight,b.clientHeight,a.clientHeight)};d._getWinHeight=function(){return Number(e.innerHeight)||Number(e.clientHeight)};(function(a){a.Queue=function(b){this.end=this.start=0;!isNaN(b)&&(this.smoother=new a.Queue.Smoother(this,.001*b))};a.Queue.prototype=Array.prototype.slice.call(Array.prototype);a.Queue.prototype.add=function(a){if(!(a instanceof
    Array))if("object"===typeof a)a=[a];else return;a.forEach(function(a){if(a=q(a,this))this.push(a),this.end<a.params.start+a.params.duration&&(this.end=a.params.start+a.params.duration)}.bind(this));this.sort(function(a,b){return a.params.duration-b.params.duration});this.start=this[0]&&this[0].params.start||0;return this};a.Queue.prototype.getIntersection=function(a,c){return p(this.start,this.end,a,c)};a.Queue.Smoother=function(a,c){this.status="idle";this.animateTo=this.animateFrom=0;this.maxSpeed=
    +c;this.queue=a};a.Queue.Smoother.prototype.render=function(a,c){this.queue.forEach(function(d){var e=d.getIntersection(a,c);e&&d.render(e.to)})};a.Queue.Smoother.prototype.step=function(){var b=this.animateTo-this.animateFrom;Math.abs(b)>this.maxSpeed?(this.render(this.animateFrom,this.animateFrom+=this.maxSpeed*(0<b?1:-1)),a._requestAnimationFrame(this.step.bind(this))):(this.render(this.animateFrom,this.animateTo),this.status="idle",this.animateFrom=this.animateTo)};a.Queue.Smoother.prototype.smooth=
    function(b,c){var d=this.queue.getIntersection(b,c);if(d)return this.animateTo=d.to,"idle"===this.status&&(this.status="busy",a._requestAnimationFrame(this.step.bind(this))),this.id=a._requestAnimationFrame(this.step.bind(this)),this}})(d);d._render=function(a){n.forEach(function(b){b.forEach(function(b){b.render(a)})});m.forEach(function(b){b.smoother.smooth(d.lastProgress,a)});d.lastProgress=a}.bind(d);d.lastProgress=0;d._catch=function(a){a=(isNaN(a)?f(document).scrollTop():a)/(h-l);this._render(a)};
    d.add=function(a,b){var c;a=a||[];c=(new this.Queue(b)).add(a);(b?m:n).push(c);return c}.bind(d);d.knock=function(a){this._catch(a);isNaN(a)&&setTimeout(this._catch.bind(this),100)};f(window).resize(function(){l=f(window).height();h=f(document).height();n.forEach(function(a){a.forEach(function(a){a.recalc(h)})});m.forEach(function(a){a.forEach(function(a){a.recalc(h)})})});d.isTouchMode="ontouchstart"in window;f(document).ready(function(){h=f(document).height();l=f(window).height()});e.Scrollissimo=
        d})(this,jQuery);
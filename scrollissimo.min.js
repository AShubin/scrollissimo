/**
 * Scrollissimo
 * Javascript plugin for scroll animation
 * @author frux
 */
(function(f){for(var n=0,h=["ms","moz","webkit","o"],k=0;k<h.length&&!f.requestAnimationFrame;++k)f.requestAnimationFrame=f[h[k]+"RequestAnimationFrame"],f.cancelAnimationFrame=f[h[k]+"CancelAnimationFrame"]||f[h[k]+"CancelRequestAnimationFrame"];f.requestAnimationFrame||(f.requestAnimationFrame=function(k,h){var c=(new Date).getTime(),m=Math.max(0,16-(c-n)),l=f.setTimeout(function(){k(c+m)},m);n=c+m;return l});f.cancelAnimationFrame||(f.cancelAnimationFrame=function(f){clearTimeout(f)})})(this); function Scrollissimo(f){function n(b,a,d){b.addEventListener?b.addEventListener(a,d,!1):b.attachEvent("on"+a,b[a+d])}function h(){var b=document.documentElement,a=document.body;return Math.max(a.scrollHeight,b.scrollHeight,a.offsetHeight,b.offsetHeight,a.clientHeight,b.clientHeight)}function k(b,a){a=a||l;if("string"===typeof b)return"%"===b.substr(-1,1)?parseInt(b)/100:"px"===b.substr(-2,2)?parseInt(b)/a:parseInt(b)/h();if(!isNaN(b))return b/a}function w(b,a,d){if("object"===typeof a){var g={}; g.property=a.property;g.from=a.from||0;g.to=a.to||0;g.prefix=a.prefix||"";g.suffix=a.suffix||"";g.duration=k(a.duration)||0;g.maxSpeed=parseFloat(a.maxSpeed);"undefined"===typeof(g.start=k(a.start))&&(g.start=d.endTime,d.endTime+=g.duration);g.queue=d;return{animator:null,sourceParams:a,params:g,render:function(a){a=(a-this.params.start)/this.params.duration;0<a&&1>a?p(b,this.params.property,this.params.prefix+(this.params.from+(this.params.to-this.params.from)*a)+this.params.suffix):1<=a?p(b,this.params.property, this.params.prefix+this.params.to+this.params.suffix):0>=a&&p(b,this.params.property,this.params.prefix+this.params.from+this.params.suffix)},recalc:function(a){a=a||h();this.params.duration=k(this.sourceParams.duration||"",a);"undefined"===typeof this.sourceParams.start&&(this.params.start=k(this.sourceParams.start,a))},getIntersection:function(a,b){var d=Math.min(a,b),e=Math.max(a,b),g=this.params.start,c=this.params.start+this.params.duration;if(d<=g&&e>=g)d=g,e=Math.min(e,c);else if(e>=c&&d<= c)d=Math.max(d,g),e=Math.min(e,c);else if(!(d>=g&&e<=c))return;return a<b?{from:d,to:e}:{from:e,to:d}}}}}function t(){var b=u(),a=b/(l-v);b!==m&&(this.Smoother(a),this.render(a));m=b}var c={},m=0,l=h()||0,v=Number(window.innerHeight)||window.innerHeight,q=[],r=[],u,p;u="pageYOffset"in window?function(){return(window.pageYOffset||0)-(document.clientTop||0)}:function(){return(document.scrollTop||0)-(document.clientTop||0)};p=window.jQuery?function(b,a,d){$(b).css(a,d)}:function(b,a,d){b.style.setProperty(a, d)};c.Queue=function(){this.endTime=0};c.Queue.prototype=Array.prototype.slice.call(Array.prototype);c.Queue.prototype.then=function(b,a){var d=w(b,a,this);"object"===typeof d&&this.push(d);return this};(function(b){var a=0;b.Smoother=function(a){b.Smoother.smooth(a)};b.Smoother.Animator=function(a){this.status="stopped";this.animateTo=this.animateFrom=0;this.tween=a};b.Smoother.Animator.prototype.step=function(){var a=this.animateTo-this.animateFrom,b=Math.abs(a),c=this.tween.params.maxSpeed;b>c&& (a=0<a?c:-c,b=Math.abs(a));this.animateFrom+=a;this.tween.render.call(this.tween,this.animateFrom);0<b?requestAnimationFrame(this.step.bind(this)):this.status="stopped"};b.Smoother.Animator.prototype.run=function(){this.status="playing";this.id&&cancelAnimationFrame(this.id);this.id=requestAnimationFrame(this.step.bind(this));return this};b.Smoother.smooth=function(b){var c=this;q.forEach(function(f){var k=f.length,h,e,l;for(h=0;h<k;h++)if(e=f[h],(l=e.getIntersection.call(e,a,b))&&l.from!==l.to){!e.animator&& (e.animator=new c.Animator(e))||"playing"!==e.animator.status?(e.animator.animateTo=l.to,e.animator.run()):e.animator.animateTo=l.to;break}});a=b}.bind(b.Smoother)})(c);c.add=function(b,a){var d;d=(new this.Queue).then(b,a);(a.maxSpeed?q:r).push(d);return d}.bind(c);c.render=function(b){r.forEach(function(a){a.forEach(function(a){a.render(b)})})}.bind(c);n(window,"resize",function(b){v=Number(window.innerHeight)||window.innerHeight;l=h();r.forEach(function(a){a.forEach(function(a){a.recalc(l)})}); q.forEach(function(a){a.forEach(function(a){a.recalc(l)})})});n(window,"scroll",function(b){t.call(c)});requestAnimationFrame(t.bind(c));(f||function(){}).call(c);return c};
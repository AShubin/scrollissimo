/**
 * Scrollissimo
 * Javascript plugin for scroll animation
 * @author frux
 */
(function(c){for(var k=0,h=["ms","moz","webkit","o"],g=0;g<h.length&&!c.requestAnimationFrame;++g)c.requestAnimationFrame=c[h[g]+"RequestAnimationFrame"],c.cancelAnimationFrame=c[h[g]+"CancelAnimationFrame"]||c[h[g]+"CancelRequestAnimationFrame"];c.requestAnimationFrame||(c.requestAnimationFrame=function(g,h){var d=(new Date).getTime(),l=Math.max(0,16-(d-k)),m=c.setTimeout(function(){g(d+l)},l);k=d+l;return m});c.cancelAnimationFrame||(c.cancelAnimationFrame=function(c){clearTimeout(c)})})(this); function Scrollissimo(c){function k(){return Math.max(p.scrollHeight,q.scrollHeight,p.offsetHeight,q.offsetHeight,p.clientHeight,q.clientHeight)}function h(){h="pageYOffset"in window?function(){return(window.pageYOffset||0)-(document.clientTop||0)}:function(){return(document.scrollTop||0)-(document.clientTop||0)};return h()}function g(a,b){b=b||m;if("string"===typeof a)return"%"===a.substr(-1,1)?parseInt(a)/100:"px"===a.substr(-2,2)?parseInt(a)/b:parseInt(a)/k();if(!isNaN(a))return a/b}function v(a, b,e){if("object"===typeof b){var f={};f.property=b.property;f.from=b.from||0;f.to=b.to||0;f.prefix=b.prefix||"";f.suffix=b.suffix||"";f.duration=g(b.duration)||0;f.maxSpeed=parseFloat(b.maxSpeed);"undefined"===typeof(f.start=g(b.start))&&(f.start=e.endTime,e.endTime+=f.duration);f.queue=e;return{animator:null,sourceParams:b,params:f,render:function(e){e=(e-this.params.start)/this.params.duration;0<e&&1>e?n(a,this.params.property,this.params.prefix+(this.params.from+(this.params.to-this.params.from)* e)+this.params.suffix):1<=e?n(a,this.params.property,this.params.prefix+this.params.to+this.params.suffix):0>=e&&n(a,this.params.property,this.params.prefix+this.params.from+this.params.suffix)},recalc:function(a){var b={};a=a||k();b.from=this.sourceParams.from||0;b.to=this.sourceParams.to||0;b.prefix=this.sourceParams.prefix||"";b.suffix=this.sourceParams.suffix||"";b.duration=g(this.sourceParams.duration||"",a);"undefined"===typeof(b.start=g(this.sourceParams.start,a))&&(b.start=e.endTime,e.endTime+= b.duration);this.params=b},getIntersection:function(b,e){var a=Math.min(b,e),f=Math.max(b,e),d=this.params.start,c=this.params.start+this.params.duration;if(a<=d&&f>=d)a=d,f=Math.min(f,c);else if(f>=c&&a<=c)a=Math.max(a,d),f=Math.min(f,c);else if(!(a>=d&&f<=c))return;return b<e?{from:a,to:f}:{from:f,to:a}}}}}function r(){var a=h(),b=a/(m-w);a!==l&&(this.Smoother(b),this.render(b));l=a;requestAnimationFrame(r.bind(this))}var d={},l=0,m=k()||0,w=Number(window.innerHeight)||window.innerHeight,t=[],u= [],q=document.documentElement,p=document.body,n;n=window.jQuery?function(a,b,e){$(a).css(b,e)}:function(a,b,e){a.style.setProperty(b,e)};d.Queue=function(){this.endTime=0};d.Queue.prototype=Array.prototype.slice.call(Array.prototype);d.Queue.prototype.then=function(a,b){var e=v(a,b,this);"object"===typeof e&&this.push(e);return this};(function(a){var b=0;a.Smoother=function(b){a.Smoother.smooth(b)};a.Smoother.Animator=function(a){this.status="stopped";this.animateTo=this.animateFrom=0;this.tween= a};a.Smoother.Animator.prototype.step=function(){var a=this.animateTo-this.animateFrom,b=Math.abs(a),d=this.tween.params.maxSpeed;b>d&&(a=0<a?d:-d,b=Math.abs(a));this.animateFrom+=a;this.tween.render.call(this.tween,this.animateFrom);0<b?requestAnimationFrame(this.step.bind(this)):this.status="stopped"};a.Smoother.Animator.prototype.run=function(){this.status="playing";this.id&&cancelAnimationFrame(this.id);this.id=requestAnimationFrame(this.step.bind(this));return this};a.Smoother.smooth=function(a){var d= this;t.forEach(function(c){c.forEach(function(c){var g=c.getIntersection.call(c,b,a);g&&g.from!==g.to&&(!c.animator&&(c.animator=new d.Animator(c))||"playing"!==c.animator.status?(c.animator.animateTo=g.to,c.animator.run()):c.animator.animateTo=g.to)})});b=a}.bind(a.Smoother)})(d);d.add=function(a,b){var c;c=(new this.Queue).then(a,b);(b.maxSpeed?t:u).push(c);return c}.bind(d);d.render=function(a){u.forEach(function(b){b.forEach(function(b){b.render(a)})})}.bind(d);window.addEventListener("scroll", function(){}.bind(d));requestAnimationFrame(r.bind(d));(c||function(){}).call(d);return d};
/**
 * Scrollissimo
 * Javascript plugin for scroll animation
 * @author frux
 */
(function(){for(var m=0,f=["ms","moz","webkit","o"],g=!(!window.performance||!window.performance.now),e=0,h=f.length;e<h&&!window.requestAnimationFrame;e+=1)window.requestAnimationFrame=window[f[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[f[e]+"CancelAnimationFrame"]||window[f[e]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(f,d){var k=(new Date).getTime(),e=Math.max(0,16-(k-m)),g=window.setTimeout(function(){f(k+e)},e);m=k+ e;return g});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});if(!g){var q=window.requestAnimationFrame,r=+new Date;window.requestAnimationFrame=function(e,d){q(function(d){return e(1E12>d?d:d-r)},d)}}})(); function Scrollissimo(m){function f(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function g(){var a=document.documentElement,b=document.body;return Math.max(b.scrollHeight,a.scrollHeight,b.offsetHeight,a.offsetHeight,b.clientHeight,a.clientHeight)}function e(a,b,c,d){var e=Math.min(c,d),f=Math.max(c,d);if(e<=a&&f>=a)b=Math.min(f,b);else if(f>=b&&e<=b)a=Math.max(e,a),b=Math.min(f,b);else if(e>=a&&f<=b)b=a=e;else return;return c<d?{from:a,to:b}:{from:b,to:a}}function h(a, b){b=b||l;if("string"===typeof a)return"%"===a.substr(-1,1)?parseInt(a)/100:"px"===a.substr(-2,2)?parseInt(a)/b:parseInt(a)/g();if(!isNaN(a))return a/b}function q(a,b){if("object"===typeof a){var c={};c.property=a.property;c.from=a.from||0;c.to=a.to||0;c.prefix=a.prefix||"";c.suffix=a.suffix||"";c.duration=h(a.duration)||0;"undefined"===typeof(c.start=h(a.start))&&(c.start=b.end);c.queue=b;return{animator:null,target:a.target,sourceParams:a,params:c,render:r.bind(this,c.start,c.duration,(a.func|| function(b){v(a.target,c.property,c.prefix+(c.from+(c.to-c.from)*b)+c.suffix)}).bind(a.target)),recalc:function(a){a=a||g();this.params.duration=h(this.sourceParams.duration||"",a);"undefined"===typeof this.sourceParams.start&&(this.params.start=h(this.sourceParams.start,a))},getIntersection:function(a,b){return e(this.params.start,this.params.start+this.params.duration,a,b)}}}}function r(a,b,c,d){a=(d-a)/b;0<a&&1>a?c(a):1<=a?c(1):0>=a&&c(0)}function n(){var a=w(),b=a/(l-u);a!==k&&this.render(b); k=a}var d={},k=0,l=g()||0,u=Number(window.innerHeight)||window.innerHeight,p=[],t=[],w,v;w="pageYOffset"in window?function(){return(window.pageYOffset||0)-(document.clientTop||0)}:function(){return(document.scrollTop||0)-(document.clientTop||0)};v=window.jQuery?function(a,b,c){$(a).css(b,c)}:function(a,b,c){a.style.setProperty(b,c)};d.Queue=function(a){this.end=this.start=0;!isNaN(a)&&(this.smoother=new d.Queue.Smoother(this,a))};d.Queue.prototype=Array.prototype.slice.call(Array.prototype);d.Queue.prototype.add= function(a){if(!(a instanceof Array))if("object"===typeof a)a=[a];else return;a.forEach(function(a){if(a=q(a,this))this.push(a),this.end<a.params.start+a.params.duration&&(this.end=a.params.start+a.params.duration)}.bind(this));this.sort(function(a,c){return a.params.duration-c.params.duration});this.start=this[0]&&this[0].params.start||0;return this};d.Queue.prototype.getIntersection=function(a,b){return e(this.start,this.end,a,b)};d.Queue.Smoother=function(a,b){this.status="idle";this.animateTo= this.animateFrom=0;this.maxSpeed=+b;this.queue=a};d.Queue.Smoother.prototype.render=function(a,b){this.queue.forEach(function(c){var d=c.getIntersection(a,b);d&&c.render(d.to)})};d.Queue.Smoother.prototype.step=function(){var a=this.animateTo-this.animateFrom;Math.abs(a)>this.maxSpeed?(this.render(this.animateFrom,this.animateFrom+=this.maxSpeed*(0<a?1:-1)),requestAnimationFrame(this.step.bind(this))):(this.render(this.animateFrom,this.animateTo),this.status="idle",this.animateFrom=this.animateTo)}; d.Queue.Smoother.prototype.smooth=function(a,b){var c=this.queue.getIntersection(a,b);if(c)return this.animateTo=c.to,"idle"===this.status&&(this.status="busy",requestAnimationFrame(this.step.bind(this))),this.id=requestAnimationFrame(this.step.bind(this)),this;d.Queue.Smoother.smooth=function(a){var b=this;p.forEach(function(c){c.forEach(function(c){var d=c.getIntersection.call(c,lastProgress,a);d&&d.from!==d.to&&(!c.animator&&(c.animator=new b.Animator(c))||"playing"!==c.animator.status?(c.animator.animateTo= d.to,c.animator.run()):c.animator.animateTo=d.to)})});lastProgress=a}.bind(d.Smoother)};d.add=function(a,b){var c;a=a||[];c=(new this.Queue(b)).add(a);(b?p:t).push(c);return c}.bind(d);d.render=function(a){t.forEach(function(b){b.forEach(function(b){b.render(a)})});p.forEach(function(b){b.smoother.smooth(d.lastProgress,a)});d.lastProgress=a}.bind(d);d.lastProgress=0;f(window,"resize",function(){u=Number(window.innerHeight)||window.innerHeight;l=g();t.forEach(function(a){a.forEach(function(a){a.recalc(l)})}); p.forEach(function(a){a.forEach(function(a){a.recalc(l)})})});"undefined"!==typeof window.ontouchstart?function(){var a=0;f(document.body,"touchstart",function(b){a=b.touches[0].clientY});f(document.body,"touchmove",function(b){var c=a-b.touches[0].clientY;a=b.touches[0].clientY;$(document).scrollTop($(document).scrollTop()+c);n.call(d);setTimeout(function(){n.call(d)},100);b.preventDefault();return!1});f(document.body,"touchend",function(b){a=b.pageY})}():f(window,"scroll",function(){n.call(d);setTimeout(function(){n.call(d)}, 100)});(m||function(){}).call(d);return d};